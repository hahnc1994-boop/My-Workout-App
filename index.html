<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gym Track Pro</title>
    <style>
        :root { --bg: #000000; --card: #1c1c1e; --primary: #0a84ff; --text: #ffffff; --accent: #32d74b; --input-bg: #2c2c2e; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); padding: 15px; margin: 0; padding-bottom: 120px; }
        .header { background: var(--bg); padding: 10px 0; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 10; }
        .card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 4px solid var(--primary); }
        .exercise-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .exercise-name { background: transparent; border: none; color: var(--primary); font-size: 1.2rem; font-weight: bold; width: 80%; outline: none; }
        .set-row { display: grid; grid-template-columns: 0.5fr 1.5fr 1.5fr 0.5fr; gap: 10px; margin-bottom: 10px; align-items: center; }
        input[type="number"], input[type="text"] { background: var(--input-bg); border: none; color: white; padding: 12px; border-radius: 8px; font-size: 1rem; text-align: center; width: 100%; box-sizing: border-box; }
        input[type="date"] { color: white; background: #333; padding: 8px; border-radius: 5px; border: 1px solid #444; }
        .label { font-size: 0.7rem; color: #8e8e93; text-transform: uppercase; text-align: center; }
        .btn-add-set { background: #2c2c2e; color: var(--primary); border: none; padding: 10px; border-radius: 8px; width: 100%; font-weight: bold; margin-top: 5px; }
        .btn-add-ex { background: #1c1c1e; color: var(--text); border: 2px dashed #444; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; font-size: 1rem; margin-top: 10px; }
        .save-footer { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.9); padding: 20px; backdrop-filter: blur(10px); border-top: 1px solid #333; }
        .remove-set { color: #ff453a; text-align: center; font-weight: bold; cursor: pointer; font-size: 1.2rem; }
    </style>
</head>
<body>

<div class="header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <input type="date" id="date-picker" onchange="updateUI()">
        <div id="workout-label" style="font-size: 0.9rem; color: var(--accent); font-weight: bold;"></div>
    </div>
</div>

<div id="exercise-list" style="margin-top: 20px;"></div>

<button class="btn-add-ex" onclick="addExercise()">+ Add Exercise</button>

<div class="save-footer">
    <button id="save-btn" onclick="saveWorkout()" style="width:100%; background:var(--accent); color:black; border:none; padding:15px; border-radius:12px; font-weight:bold; font-size: 1.1rem;">SAVE WORKOUT TO SHEETS</button>
</div>

<script>
    // Your exact workout split logic
    const splitNames = ["Sunday: Volume Legs", "Monday: Volume Back", "Tuesday: Volume Chest", "Wednesday: Rest Day", "Thursday: Heavy Legs", "Friday: Heavy Back", "Saturday: Heavy Chest"];
    const mainLifts = ["Front Squat", "Light Deadlift", "Incline Bench", "", "Back Squat", "Deadlift", "Bench Press"];

    // Set initial date to today
    document.getElementById('date-picker').valueAsDate = new Date();

    function updateUI() {
        const dateInput = document.getElementById('date-picker').value;
        const dateVal = new Date(dateInput + 'T00:00:00');
        const dayIndex = dateVal.getDay();
        
        document.getElementById('workout-label').innerText = splitNames[dayIndex];
        document.getElementById('exercise-list').innerHTML = "";
        
        // Auto-generate primary lift if it's not a rest day
        if (mainLifts[dayIndex] !== "") {
            addExercise(mainLifts[dayIndex]);
        }
    }

    function addExercise(name = "") {
        const container = document.getElementById('exercise-list');
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
            <div class="exercise-header">
                <input type="text" class="exercise-name" value="${name}" placeholder="Exercise Name">
                <div style="color: #444;" onclick="this.parentElement.parentElement.remove()">✕</div>
            </div>
            <div class="set-row">
                <div class="label">Set</div><div class="label">Lbs</div><div class="label">Reps</div><div></div>
            </div>
            <div class="set-container"></div>
            <button class="btn-add-set" onclick="addSet(this)">+ Add Set</button>
        `;
        container.appendChild(div);
        addSet(div.querySelector('.btn-add-set'));
    }

    function addSet(btn) {
        const container = btn.previousElementSibling;
        const setNum = container.children.length + 1;
        
        let lastW = "", lastR = "";
        if (setNum > 1) {
            lastW = container.lastElementChild.querySelectorAll('input')[0].value;
            lastR = container.lastElementChild.querySelectorAll('input')[1].value;
        }

        const row = document.createElement('div');
        row.className = 'set-row';
        row.innerHTML = `
            <div style="text-align:center; font-weight:bold;">${setNum}</div>
            <input type="number" value="${lastW}" placeholder="---">
            <input type="number" value="${lastR}" placeholder="---">
            <div class="remove-set" onclick="this.parentElement.remove()">✕</div>
        `;
        container.appendChild(row);
    }

    async function saveWorkout() {
        const url = https://script.google.com/macros/s/AKfycbygcgrTFkyiJKUjB2xKnMDQILdD8rIwHSqMtpO1kaY6OFLX4PCvqpSdfx81jXVswWko/exec; // PASTE YOUR GOOGLE URL HERE
        if (url.includes("YOUR_WEB")) {
            alert("Please paste your Google Web App URL into the code first!");
            return;
        }

        const saveBtn = document.getElementById('save-btn');
        saveBtn.innerText = "SAVING...";
        saveBtn.disabled = true;

        const date = document.getElementById('date-picker').value;
        const allData = [];

        document.querySelectorAll('.card').forEach(card => {
            const name = card.querySelector('.exercise-name').value;
            card.querySelectorAll('.set-row').forEach((row, index) => {
                const inputs = row.querySelectorAll('input');
                if(inputs.length >= 2 && inputs[0].value !== "") {
                    allData.push({
                        date: date,
                        exercise: name,
                        set: index, // Row index is the set number
                        weight: inputs[0].value,
                        reps: inputs[1].value
                    });
                }
            });
        });

        if(allData.length === 0) {
            alert("No data to save!");
            saveBtn.disabled = false;
            saveBtn.innerText = "SAVE WORKOUT TO SHEETS";
            return;
        }

        try {
            await fetch(url, {
                method: "POST",
                mode: "no-cors", // Required for Google Apps Script
                body: JSON.stringify(allData)
            });
            alert("Workout Logged Successfully!");
        } catch (e) {
            alert("Error saving: " + e);
        }

        saveBtn.disabled = false;
        saveBtn.innerText = "SAVE WORKOUT TO SHEETS";
    }

    updateUI();
</script>

</body>
</html>